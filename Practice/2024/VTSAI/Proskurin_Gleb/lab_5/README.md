# Лабораторная работа 5

Выполнили:
* Герасимчук Михаил (P4241)
* Проскурин Глеб (P4241)


## Исследование влияния числа эпох обучения

В этой части исследования мы фокусируемся на анализе того, как изменение количества эпох обучения влияет на представления узлов и на метрику Node Similarity. Исследование включает:

- **Изменение числа эпох**: Мы проводим обучение с различным количеством эпох и наблюдаем, как это влияет на качество вложений узлов.
- **Анализ Node Similarity**: Мы анализируем, как изменение количества эпох влияет на меру сходства узлов.
- **Визуализация**: Добавляем график, отображающий изменение Node Similarity в зависимости от числа эпох.

## Сравнение различных моделей

Мы также исследуем эффективность различных моделей графовых вложений, таких как ComplEx и TransE, сравнивая их способность к предсказанию отношений и измерению Node Similarity. Это помогает понять, какие модели лучше справляются с задачами предсказания в контексте графовых нейронных сетей.

## Анализ случайных узлов

- **Выборка случайных узлов**: Мы выбираем несколько случайных узлов и анализируем их сходство с другими узлами в графе.
- **Влияние числа эпох**: Особое внимание уделяется изменениям в сходстве узлов при изменении числа эпох обучения.
- **Использование различных моделей**: Анализируем, как выбор модели влияет на сходство между узлами.

## Измерение Node Similarity

Node Similarity играет ключевую роль в анализе графов, выявляя связи и паттерны между узлами. Мы используем различные метрики для измерения сходства узлов:

- **Косинусная схожесть (Cosine Similarity)**: Измеряет угол между векторами признаков узлов.
- **Манхэттенское расстояние (Manhattan Distance)**: Оценивает сумму абсолютной разницы между координатами узлов.
- **Евклидово расстояние (Euclidean Distance)**: Измеряет расстояние между узлами как точками в пространстве.

Мы визуализируем результаты в виде матрицы близости, используя функции `euclidean_distances`, `cosine_similarity` и `manhattan_distances` из scikit-learn.

## Поиск соседей узла

Одна из важных задач, где используется Node Similarity, - это поиск ближайших соседей узла в графе. Мы применяем методы NearestNeighbors, используя рассмотренные выше метрики близости, для анализа соседства узлов на основе их представлений.

## Результаты и Выводы

| Модель             | Hits@1 | Hits@5 | Hits@10 | Ближайшие узлы для ussr (cosine)                 | Ближайшие узлы для india (cosine)                               |
|--------------------|--------|--------|---------|---------------------------------------------------------|-----------------------------------------------------------------|
| ComplEx (100 epoch) | 0.176    | 0.69 | 0.967  | 'india', 'brazil', 'usa'                  |  'ussr', 'cuba', 'israel' |
| ComplEx (200 epoch)| 0.176   | 0.67 | 0.93  | 'israel', 'uk', 'indonesia'              | 'china', 'brazil', 'poland'                         |
| TransE (100 epoch) | 0.0 | 0.781  | 0.977   | 'poland', 'usa', 'uk'    | 'usa', 'uk', 'poland'     |


1. Уменьшение количества эпох обучения для модели ComplEx с 100 до 200 привело к незначительному снижению качества модели.
2. В контексте данного исследования, модель TransE показала наилучшие результаты, если сравнивать с  ComplEx при одинаковых количествах эпох.





