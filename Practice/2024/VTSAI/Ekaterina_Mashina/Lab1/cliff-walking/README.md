 
## Лабораторная работа 1

Выполнили: <br>
Машина Е. P4241 <br>
Щербаков В. P4216

### Задание

В рамках самостоятельной работы мы продемонстрировали использование библиотек для работы с окружением OpenAI Gym, обучения модели глубокого обучения на примере задачи CliffWalking-v0, и визуализации результатов обучения в Colab с использованием анимации.

1. **Установка библиотек:**
Были установлены необходимые библиотеки и зависимости, такие как Gymnasium, Stable-Baselines3, PyVirtualDisplay, и Xvfb. Это необходимо для работы с окружением, обучения модели и визуализации в Colab.

2. **Импорт и настройка окружения:**
Импортированы библиотеки, такие как Gym и Stable-Baselines3, и создано окружение задачи CliffWalking-v0. Пространства наблюдения и действий были извлечены для дальнейшего использования в обучении.

3. **Обучение модели:**
Использован алгоритм DQN для обучения модели глубокого обучения на среде CliffWalking-v0. Модель обучалась на протяжении заданного количества временных шагов, и результаты сохранены для дальнейшего использования.
    1. Была обучена модель DQN с увеличенным кол-вом шагов обучения
    2. Подобраны параметры модели для максимизации reward (удалось увеличить с -5000 до -15)
    3. (Ввиду некорректного кода визуализации) Были предприняты попытки:
        - Повышения размерности входных данных (координаты разбиты на 2 числа, добавлено время)
        - Замены алгоритма рассчёта награды (изначально -1 за каждый шаг, -100, если агент упал со скалы).
       
       После исправления кода (см. пункт 3.4) визуализации была использована изначальная модель с подобранными параметрами.
    4. Изменён код визуализации:
        - Заменёна библиотека gym на gymnasium
        - Разделены этапы сбора данных и их визуализации
        - Убран код сброса среды на каждом шаге, чтобы получить полную картину движения модели

4. **Виртуальный дисплей и визуализация:**
Установлен виртуальный дисплей (Xvfb) для визуализации окружения в Colab. Библиотеки PyVirtualDisplay и Matplotlib использовались для создания анимации, которая отображает визуальные результаты тестирования обученной модели.

5. **Анимация и вывод:**
Создан цикл, в котором обученная модель использовалась для прогнозирования действий в среде. Кадры среды были записаны в виде изображений, а затем использованы для создания анимации. Анимация была отображена в ячейке вывода Colab.

6. **Закрытие среды:**
В конце кода среда была закрыта для освобождения ресурсов.
